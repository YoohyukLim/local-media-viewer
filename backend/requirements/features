# 기능 요구사항

## 1. 비디오 관리 기능
- [x] 설정된 디렉토리의 비디오 파일 자동 스캔
- [x] 비디오 메타데이터 추출 (길이, 수정 시간 등)
- [x] 디렉토리 기반 자동 태그 생성

## 2. 썸네일 생성 기능
- [x] 비디오 파일에서 WebP 애니메이션 썸네일 생성
- [x] 임시 파일(.tmp) 사용으로 안전한 파일 생성
- [x] 기존 썸네일 존재 시 중복 생성 방지
- [x] 비디오 파일이 더 최신인 경우에만 업데이트
- [x] 썸네일 크기, FPS, 길이 등 설정 가능

## 3. 멀티프로세싱
- [x] ProcessPoolExecutor로 병렬 처리
- [x] 워커 수 설정 가능 (config.yaml의 max_workers)
- [x] spawn 컨텍스트 사용으로 안정성 확보
- [x] KeyboardInterrupt 무시 처리

## 4. 로깅 시스템
- [x] 싱글톤 패턴의 LogManager
- [x] 큐 기반 스레드 안전 로깅
- [x] 콘솔 출력 포맷팅
- [x] 안전한 종료 처리

## 5. 프로세스 관리
- [x] 시그널 핸들러 (SIGINT, SIGTERM)
- [x] 리소스 정리 순서 최적화
- [x] 중복 종료 방지
- [x] 진행 중인 작업 안전한 취소

## 6. 에러 처리
- [x] 각 단계별 예외 처리
- [x] 임시 파일 자동 정리
- [x] 로깅 시스템 종료 시 예외 처리
- [x] 스레드/프로세스 동기화

## 7. 메타데이터 관리
- [x] 카테고리: .info 파일의 ! 시작 라인
- [x] 태그: .info 파일의 # 시작 라인
- [x] 태그 자동 생성 및 연결
- [x] 사용되지 않는 태그 자동 정리

## 8. API 엔드포인트
- [x] /api/videos/scan: 비디오 스캔 실행
- [x] /api/videos/list: 비디오 목록 조회 (페이징)
  - [x] 파일명 기준 정렬
  - [x] 페이지 번호, 페이지 크기 지정
  - [x] 전체 아이템 수, 전체 페이지 수 포함
- [x] /api/videos/tags: 전체 태그 목록 조회
- [x] /api/videos/search: 태그 기반 비디오 검색 (페이징)
  - [x] AND/OR 검색 지원 (require_all 파라미터)
  - [x] 페이지 번호, 페이지 크기 지정
  - [x] 전체 아이템 수, 전체 페이지 수 포함
- [x] /api/videos/{id}/tags: 태그 추가/제거
  - [x] POST: 태그 추가 (태그 이름)
  - [x] DELETE: 태그 제거 (태그 ID)

## 9. 자동화
- [x] 서버 시작 시 자동 스캔
- [x] 설정 파일 변경 시 자동 리로드
- [x] 스캔 시 자동 정리 작업
  - [x] 누락된 파일 제거
  - [x] 외부 파일 제거
  - [x] 사용되지 않는 태그 제거

## 10. 서버 설정
- [x] 커맨드라인 인자로 호스트/포트 지정
- [x] 기본값: localhost:8000
- [x] 자동 리로드 지원 